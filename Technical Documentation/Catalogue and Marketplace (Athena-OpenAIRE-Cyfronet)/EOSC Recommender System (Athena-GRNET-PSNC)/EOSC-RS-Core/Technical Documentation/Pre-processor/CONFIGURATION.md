# Licence

<! --- SPDX-License-Identifier: CC-BY-4.0  -- >

## Introduction

- Purpose of the document and intended audience.
- Importance of proper configuration for the software/application.

## Configuration Overview

- Brief overview of the configuration process.
- Explanation of how configuration affects the behaviour of the software.

## Configuration Files

### Hadoop & Spark
- configurations files (`.xml`), see [hadoop config](../hadoop-config/README.md) and [deployment](DEPLOYMENT.md)

###
- Preprocessor service uses `.env` file

## Environmental Variables


| Name                                   | Default value                                    | Description                                                                                                                                                                                       |
|----------------------------------------|--------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| ARTIFICIAL_STOMP_ADDRESS               |                                                  | Not relevant, used to artificial flow with generated User Actions                                                                                                                                 |
| ARTIFICIAL_STOMP_PASSWORD              |                                                  | Not relevant, used to artificial flow with generated User Actions                                                                                                                                 |
| ARTIFICIAL_STOMP_USERNAME              |                                                  | Not relevant, used to artificial flow with generated User Actions                                                                                                                                 |
| CRON_DAILY_CALCULATIONS                | 0 0 0 * * *                                      | CRON for daily statistics calculations                                                                                                                                                            |
| CRON_SESSION_REMOVER                   | 0 0 0/4 * * *                                    | CRON for users sessions remover                                                                                                                                                                   |
| CRON_TODAY_UPDATE                      | 0 9/10 * * * *                                   | CRON for partial data backup of the day                                                                                                                                                           |
| ENABLE_SCHEDULER                       | true                                             | Set false to disable scheduled updates of statistics                                                                                                                                              |
| FLYWAY_ENABLE                          | true                                             | Set to false to disable Flyway                                                                                                                                                                    |
| HADOOP_USER_NAME                       | hadoop                                           | Hadoop username                                                                                                                                                                                   |
| JMS_TOPIC_DB_EVENTS                    | mp_db_events                                     | Name of JMS topic for Marketplace database events                                                                                                                                                 |
| JMS_TOPIC_RECOMMENDATION               | recommendations                                  | Name of JMS topic for resources recommendations                                                                                                                                                   |
| JMS_TOPIC_USER_ACTIONS                 | user_actions                                     | Name of JMS topic for User Action                                                                                                                                                                 |
| JMS_TOPIC_GENERATED_USER_ACTIONS       | artificial_user_actions_local                    | Not relevant, used to artificial flow with generated User Actions                                                                                                                                 |
| KAFKA_ADDRESS                          |                                                  | Kafka address                                                                                                                                                                                     |
| KAFKA_AUTO_CREATE_TOPICS               | false                                            | When set to true, it creates the required topics on Kafka                                                                                                                                         |
| KAFKA_TOPIC_ARTIFICIAL_SESSION         | artificial-session-default                       | Not relevant, used to artificial flow with generated User Actions                                                                                                                                 |
| KAFKA_TOPIC_ARTIFICIAL_STATS           | artificial-stats-default                         | Not relevant, used to artificial flow with generated User Actions                                                                                                                                 |
| KAFKA_TOPIC_SESSION                    | eosc-session-default                             | Name of Kafka topic for users sessions                                                                                                                                                            |
| KAFKA_TOPIC_STATS                      | eosc-stats-default                               | Name of Kafka topic for users statistics                                                                                                                                                          |
| KAFKA_TOPIC_SPARK                      | spark-status-default                             | Name of Kafka topic for Spark jobs statuses                                                                                                                                                       |
| KAFKA_TOPIC_USER_SYNC                  | user-sync-default                                | Name of Kafka topic for synchronizing data regarding Users                                                                                                                                        |
| KAFKA_TOPIC_SERVICE_SYNC               | service-sync-default                             | Name of Kafka topic for synchronizing data regarding Services                                                                                                                                     |
| KAFKA_TOPIC_TRAINING_SYNC              | training-sync-default                            | Name of Kafka topic for synchronizing data regarding Trainings                                                                                                                                    |
| KAFKA_TOPIC_RECOMMENDATIONS_EVALUATION | recommendations-evaluations-default              | Name of Kafka topic for recommendations evaluations                                                                                                                                               |
| LOGGING_LEVEL_PREPROCESSOR             | WARN                                             | Logging level for application packages                                                                                                                                                            |
| LOGGING_LEVEL_ROOT                     | ERROR                                            | Root logging level                                                                                                                                                                                |
| DB_PASSWORD                            | secret                                           | PostgreSQL password                                                                                                                                                                               |
| DB_URL                                 | x                                                | PostgreSQL URL                                                                                                                                                                                    |
| DB_USERNAME                            | preproc                                          | PostgreSQL username                                                                                                                                                                               |
| SPARK_USER                             | hadoop                                           | Spark user                                                                                                                                                                                        |
| SEARCHSERVICE_API_BASE_PATH            | https://api.eosc-search-service.grid.cyfronet.pl | Search Service API address                                                                                                                                                                        |
| SEARCHSERVICE_S3_ACCESS_KEY            |                                                  | Search Service S3 access key                                                                                                                                                                      |
| SEARCHSERVICE_S3_ENDPOINT              | https://s3.cloud.cyfronet.pl                     | Search Service S3 endpoint                                                                                                                                                                        |
| SEARCHSERVICE_S3_SECRET_KEY            |                                                  | Search Service S3 secret                                                                                                                                                                          |
| SEARCHSERVICE_S3_BUCKET_NAME           | ess-mock-dumps                                   | Search Service S3 bucket name                                                                                                                                                                     |
| SEARCHSERVICE_S3_URI_SCHEME            | s3a                                              | Search Service S3 URI scheme                                                                                                                                                                      |
| SESSION_EXPIRATION                     | 1800000                                          | Session expiration for removing active user session [ms]                                                                                                                                          |
| SESSION_EXPIRATION_DELAY               | 3600000                                          | Session expiration delay for removing active user session [ms]                                                                                                                                    |
| SHOW_SQL                               | false                                            | Change for debugging SQL queries                                                                                                                                                                  |
| SPRING_PROFILES                        |                                                  | Not relevant, only for specific purposes: `ua-generator` - generate artificial User Actions, `backup-raw-jms` - write raw jms events to PSQL, `artificial-flow` - process artificial User Actions |
| SPARK_HOME                             |                                                  | Spark home path                                                                                                                                                                                   |
| STOMP_ADDRESS                          |                                                  | Stomp/JMS address                                                                                                                                                                                 |
| STOMP_PASSWORD                         |                                                  | Stomp/JMS password                                                                                                                                                                                |
| STOMP_USERNAME                         |                                                  | Stomp/JMS username                                                                                                                                                                                |
| BETA_STOMP_ADDRESS                     |                                                  | BETA Stomp/JMS address. Set the same value as STOMP_ADDRESS                                                                                                                                       |
| BETA_STOMP_PASSWORD                    |                                                  | BETA Stomp/JMS password. Set the same value as STOMP_PASSWORD                                                                                                                                     |
| BETA_STOMP_USERNAME                    |                                                  | BETA Stomp/JMS username. Set the same value as STOMP_USERNAME                                                                                                                                     |
| WEBHDFS_BASE_PATH                      | swebhdfs://hdfs.dev.pl:443/                      | Address of HDFS using Protocol swebhdfs                                                                                                                                                           |
| ZERO_DATE_DAY                          | 1                                                | Date reference point for calculating statistics - day                                                                                                                                             |
| ZERO_DATE_MONTH                        | 6                                                | Date reference point for calculating statistics - month                                                                                                                                           |
| ZERO_DATE_YEAR                         | 2022                                             | Date reference point for calculating statistics - year                                                                                                                                            |
| KAFKA_CONFIG_PARTITIONS                | 10                                               | Default number of partitions for creating kafka topic                                                                                                                                             |
| KAFKA_CONFIG_REPLICAS                  | 2                                                | Default number of replicas for creating kafka topic                                                                                                                                               |

## Security Considerations
The .env file should never be committed to the repository. It should be created manually on the server.